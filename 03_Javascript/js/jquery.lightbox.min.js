/*
 jQuery lightBox plugin
 This jQuery plugin was inspired and based on Lightbox 2 by Lokesh Dhakar (http://www.huddletogether.com/projects/lightbox2/)
 and adapted to me for use like a plugin from jQuery.
 @name jquery-lightbox-0.5.js
 @author Leandro Vieira Pinho - http://leandrovieira.com
 @version 0.5.1
 @date April 11, 2008
 @category jQuery plugin
 @copyright (c) 2008 Leandro Vieira Pinho (leandrovieira.com)
 @license CCAttribution-ShareAlike 2.5 Brazil - http://creativecommons.org/licenses/by-sa/2.5/br/deed.en_US
 @example Visit http://leandrovieira.com/projects/jquery/lightbox/ for more informations about this jQuery plugin

 @updates by Ivaylo Stamatov aka avioli @ FULLER http://fuller.com.au/
 @date 2011-08-04
*/
var lightbox_path=lightbox_path||"";
(function(b){b.fn.lightBox=function(a){function q(d,c){b("embed, object, select").css({visibility:"hidden"});r();a.imageArray.length=0;a.activeImage=0;var e=!1,h;a.grouping&&(h=d.getAttribute("rel"))&&(e=c,c=[],e.each(function(a,b){h==b.getAttribute("rel")&&c.push(b)}));if(1==c.length){var g="gallery"==a.captionPosition?jQuery(d).parent().next().html():d.getAttribute("title");a.imageArray.push([d.getAttribute("href"),g])}else for(var f=0;f<c.length;f++)if("gallery"!=a.captionPosition)g=c[f].getAttribute("title"),
a.imageArray.push([c[f].getAttribute("href"),g]);else if(1<f){if(c[f-1].getAttribute("href")==c[f].getAttribute("href")||jQuery(c[f-1]).parent().parent().children().children().attr("href")!=jQuery(c[f]).parent().parent().children().children().attr("href"))g=jQuery(c[f]).parent().next().html(),a.imageArray.push([jQuery(c[f]).parent().parent().children().children().attr("href"),g])}else g=jQuery(c[f]).parent().next().html(),a.imageArray.push([jQuery(c[f]).parent().parent().children().children().attr("href"),
g]);for(;a.imageArray[a.activeImage][0]!=d.getAttribute("href");)a.activeImage++;a.grouping&&e&&(c=e,e=!1);k()}function r(){b("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+a.imageLoading+
'"></a></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose"><img src="'+a.imageBtnClose+'"></a></div></div></div></div>');b("#jquery-overlay").css({backgroundColor:a.overlayBgColor,opacity:a.overlayOpacity}).fadeIn();m();b("#jquery-overlay,#jquery-lightbox").click(function(){l()});
b("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){l();return!1});b(window).resize(function(){m()})}function k(){b("#lightbox-loading").show();a.fixedNavigation?b("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide():b("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var d=new Image;d.onload=function(){b("#lightbox-image").attr("src",
a.imageArray[a.activeImage][0]);s(d.width,d.height);d.onload=function(){}};d.src=a.imageArray[a.activeImage][0]}function m(){var d=n();b("#jquery-overlay").css({width:d[0],height:d[1]});var c,e;self.pageYOffset?(e=self.pageYOffset,c=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(e=document.documentElement.scrollTop,c=document.documentElement.scrollLeft):document.body&&(e=document.body.scrollTop,c=document.body.scrollLeft);c=arrayPageScroll=[c,e];b("#jquery-lightbox").css({top:c[1]+
(a.shrinkToFit?a.shrinkPadding:d[3]/10),left:c[0]})}function s(d,c){var e=b("#lightbox-container-image-box").width(),h=b("#lightbox-container-image-box").height();if(a.shrinkToFit){var g=n(),f=d/c;c>.9*g[3]-2*a.shrinkPadding&&(c=.9*g[3]-2*a.shrinkPadding,d=c*f);d>g[0]-2*a.shrinkPadding&&(d=g[0]-2*a.shrinkPadding,c=d/f)}g=d+2*a.containerBorderSize;f=c+2*a.containerBorderSize;e-=g;h-=f;b("#lightbox-container-image-box").animate({width:g,height:f},a.containerResizeSpeed,function(){t()});0==e&&0==h&&
(b.browser.msie?p(250):p(100));b("#lightbox-container-image-data-box").css({width:d});b("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:c+2*a.containerBorderSize})}function t(){b("#lightbox-loading").hide();b("#lightbox-image").fadeIn(function(){b("#lightbox-container-image-data-box").slideDown("fast");b("#lightbox-image-details-caption").hide();a.imageArray[a.activeImage][1]&&b("#lightbox-image-details-caption").html(a.imageArray[a.activeImage][1]).show();1<a.imageArray.length&&b("#lightbox-image-details-currentNumber").html(a.txtImage+
" "+(a.activeImage+1)+" "+a.txtOf+" "+a.imageArray.length).show();u()});a.imageArray.length-1>a.activeImage&&(objNext=new Image,objNext.src=a.imageArray[a.activeImage+1][0]);0<a.activeImage&&(objPrev=new Image,objPrev.src=a.imageArray[a.activeImage-1][0])}function u(){b("#lightbox-nav").show();b("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url("+a.imageBlank+") no-repeat"});0!=a.activeImage&&(a.fixedNavigation?b("#lightbox-nav-btnPrev").css({background:"url("+a.imageBtnPrev+
") left 15% no-repeat"}).unbind().bind("click",function(){a.activeImage-=1;k();return!1}):b("#lightbox-nav-btnPrev").unbind().hover(function(){b(this).css({background:"url("+a.imageBtnPrev+") left 15% no-repeat"})},function(){b(this).css({background:"transparent url("+a.imageBlank+") no-repeat"})}).show().bind("click",function(){a.activeImage-=1;k();return!1}));a.activeImage!=a.imageArray.length-1&&(a.fixedNavigation?b("#lightbox-nav-btnNext").css({background:"url("+a.imageBtnNext+") right 15% no-repeat"}).unbind().bind("click",
function(){a.activeImage+=1;k();return!1}):b("#lightbox-nav-btnNext").unbind().hover(function(){b(this).css({background:"url("+a.imageBtnNext+") right 15% no-repeat"})},function(){b(this).css({background:"transparent url("+a.imageBlank+") no-repeat"})}).show().bind("click",function(){a.activeImage+=1;k();return!1}));v()}function v(){b(document).keydown(function(d){null==d?(keycode=event.keyCode,escapeKey=27):(keycode=d.keyCode,escapeKey=d.DOM_VK_ESCAPE);key=String.fromCharCode(keycode).toLowerCase();
key!=a.keyToClose&&"x"!=key&&keycode!=escapeKey||l();key!=a.keyToPrev&&37!=keycode||0==a.activeImage||(a.activeImage-=1,k(),b(document).unbind());key!=a.keyToNext&&39!=keycode||a.activeImage==a.imageArray.length-1||(a.activeImage+=1,k(),b(document).unbind())})}function l(){b("#jquery-lightbox").remove();b("#jquery-overlay").fadeOut(function(){b("#jquery-overlay").remove()});b("embed, object, select").css({visibility:"visible"})}function n(){var a,b;window.innerHeight&&window.scrollMaxY?(a=window.innerWidth+
window.scrollMaxX,b=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(a=document.body.scrollWidth,b=document.body.scrollHeight):(a=document.body.offsetWidth,b=document.body.offsetHeight);var e,h;self.innerHeight?(e=document.documentElement.clientWidth?document.documentElement.clientWidth:self.innerWidth,h=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,h=document.documentElement.clientHeight):
document.body&&(e=document.body.clientWidth,h=document.body.clientHeight);pageHeight=b<h?h:b;pageWidth=a<e?a:e;return arrayPageSize=[pageWidth,pageHeight,e,h]}function p(a){var b=new Date;do var e=new Date;while(e-b<a)}a=jQuery.extend({overlayBgColor:"#000",overlayOpacity:.8,fixedNavigation:!1,imageLoading:lightbox_path+"images/lightbox-ico-loading.gif",imageBtnPrev:lightbox_path+"images/lightbox-btn-prev.gif",imageBtnNext:lightbox_path+"images/lightbox-btn-next.gif",imageBtnClose:lightbox_path+"images/lightbox-btn-close.gif",
imageBlank:lightbox_path+"images/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0,captionPosition:"",shrinkToFit:!0,shrinkPadding:50,grouping:!0},a);var w=this;return this.unbind("click").click(function(){q(this,w);return!1})}})(jQuery);
